<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>IP Messenger</title>
  <style>
    :root{
      --bg:#000a00;
      --text:#7CFF7C;
      --muted:#4a8b4a;
      --glow:rgba(124,255,124,0.1);
    }
    html,body{
      height:100%;
      margin:0;
      background: linear-gradient(#001200,#000800);
      color:var(--text);
      font-family:"VT323","Courier New",monospace;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .screen{width:90%;max-width:800px;padding:2rem;border:4px solid rgba(10,40,10,0.7);background:linear-gradient(180deg,rgba(0,20,0,0.9),rgba(0,10,0,0.85));border-radius:8px;position:relative;overflow:hidden;box-shadow:0 0 40px black,0 0 60px rgba(0,255,0,0.05) inset;}
    h1{text-align:center;font-size:28px;margin-top:0;text-shadow:0 0 8px var(--glow);}
    p.lead{text-align:center;color:var(--muted);font-size:14px;}
    form{display:flex;gap:10px;margin-top:20px;justify-content:center;}
    input{flex:1;max-width:300px;background:transparent;border:1px solid rgba(124,255,124,0.1);padding:10px;border-radius:4px;color:var(--text);font-size:16px;outline:none;text-align:center;}
    button{background:linear-gradient(#0b3,#074);color:#001;border:0;border-radius:4px;padding:10px 14px;cursor:pointer;font-weight:bold;}
    .messages{margin-top:20px;display:flex;flex-direction:column;gap:10px;max-height:300px;overflow-y:auto;padding-right:5px;}
    .message{max-width:70%;padding:8px 12px;border-radius:6px;border:1px solid rgba(124,255,124,0.1);background:rgba(0,30,0,0.4);word-break:break-word;}
    .mine{align-self:flex-start;background:rgba(100,255,100,0.2);border-color:rgba(124,255,124,0.5);color:#B8FFB8;font-weight:bold;}
    .other{align-self:flex-end;opacity:0.7;}
    .status{color:var(--muted);font-size:14px;margin-top:10px;text-align:center;}
    .screen::before{content:"";position:absolute;inset:0;background:linear-gradient(transparent 85%,rgba(0,0,0,0.15) 86%);background-size:100% 6px;animation:scan 3s linear infinite;mix-blend-mode:overlay;pointer-events:none;opacity:0.8;}
    @keyframes scan{from{background-position-y:0;}to{background-position-y:6px;}}
    .screen::after{content:"";position:absolute;inset:0;background:repeating-linear-gradient(90deg,rgba(255,255,255,0.02) 0 1px,transparent 1px 12px);animation:stripes 6s linear infinite;opacity:0.05;pointer-events:none;}
    @keyframes stripes{from{transform:translateX(0);}to{transform:translateX(-40px);}}
  </style>
</head>
<body>
  <div class="screen">
    <h1>ðŸ’¬ IP Messenger</h1>
    <p class="lead">You can send 2 messages per day per IP</p>

    <div class="messages" id="messages"></div>

    <form id="chatForm">
      <input type="text" id="messageInput" placeholder="Type your message..." required maxlength="200"/>
      <button type="submit">Send</button>
    </form>

    <div class="status" id="status">Detecting IP...</div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <script>
    // ðŸ”¥ Replace this with your own Firebase config
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_APP.firebaseapp.com",
      databaseURL: "https://YOUR_APP.firebaseio.com",
      projectId: "YOUR_APP",
      storageBucket: "YOUR_APP.appspot.com",
      messagingSenderId: "SENDER_ID",
      appId: "APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const messagesEl = document.getElementById('messages');
    const form = document.getElementById('chatForm');
    const input = document.getElementById('messageInput');
    const statusEl = document.getElementById('status');

    let myIP = null;
    const maxMessagesPerDay = 2;

    // Track daily usage in localStorage
    const today = new Date().toDateString();
    if(localStorage.getItem('lastReset') !== today){
      localStorage.setItem('lastReset', today);
      localStorage.setItem('dailyCount', '0');
    }
    let dailyCount = parseInt(localStorage.getItem('dailyCount')) || 0;

    // Detect IP
    fetch('https://api.ipify.org?format=json')
      .then(r=>r.json())
      .then(d=>{
        myIP = d.ip;
        statusEl.textContent = `Your IP: ${myIP}`;
      })
      .catch(()=>statusEl.textContent='Failed to detect IP');

    // Listen for new messages
    db.ref('messages').limitToLast(100).on('value', snapshot=>{
      messagesEl.innerHTML = '';
      const data = snapshot.val();
      if(data){
        Object.values(data).forEach(m=>{
          const div = document.createElement('div');
          div.className = 'message ' + (m.ip === myIP ? 'mine' : 'other');
          div.textContent = m.text;
          messagesEl.appendChild(div);
        });
        messagesEl.scrollTop = messagesEl.scrollHeight;
      }
    });

    // Send message
    form.addEventListener('submit', e=>{
      e.preventDefault();
      if(dailyCount >= maxMessagesPerDay){
        alert('You reached your daily limit of 2 messages.');
        return;
      }
      const text = input.value.trim();
      if(!text) return;
      const msg = { ip: myIP || 'unknown', text, time: Date.now() };
      db.ref('messages').push(msg);
      dailyCount++;
      localStorage.setItem('dailyCount', dailyCount);
      input.value = '';
    });
  </script>
</body>
</html>
